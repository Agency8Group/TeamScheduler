<!DOCTYPE html>
<html lang="ko">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>ì „ì‚¬ ê³µìš© ìº˜ë¦°ë”</title>
        <script src="https://cdn.tailwindcss.com"></script>
        <script>
            tailwind.config = {
                theme: {
                    extend: {
                        colors: {
                            company: "#EF4444", // íšŒì‚¬ì „ì²´ - ë¹¨ê°„ìƒ‰
                            aptamil: "#3B82F6", // ì••íƒ€ë°€ - íŒŒë€ìƒ‰
                            dreamy: "#1F2937", // ë“œë¦¬ë¯¸ - ê²€ì€ìƒ‰
                            btmall: "#F59E0B", // btëª° - ë…¸ë€ìƒ‰
                            meeting: "#EF4444", // ë¯¸íŒ… - ë¹¨ê°„ìƒ‰
                            holiday: "#10B981", // íœ´ë¬´ - ì´ˆë¡ìƒ‰
                            event: "#F59E0B", // ì´ë²¤íŠ¸ - ì£¼í™©ìƒ‰
                            deadline: "#8B5CF6", // ë§ˆê°ì¼ - ë³´ë¼ìƒ‰
                            notice: "#F97316", // ê³µì§€ - ì£¼í™©ìƒ‰
                        },
                        animation: {
                            "fade-in": "fadeIn 0.5s ease-in-out",
                            "slide-up": "slideUp 0.3s ease-out",
                            "bounce-in": "bounceIn 0.6s ease-out",
                            "pulse-slow": "pulse 3s infinite",
                        },
                        keyframes: {
                            fadeIn: {
                                "0%": { opacity: "0" },
                                "100%": { opacity: "1" },
                            },
                            slideUp: {
                                "0%": {
                                    transform: "translateY(10px)",
                                    opacity: "0",
                                },
                                "100%": {
                                    transform: "translateY(0)",
                                    opacity: "1",
                                },
                            },
                            bounceIn: {
                                "0%": { transform: "scale(0.3)", opacity: "0" },
                                "50%": { transform: "scale(1.05)" },
                                "70%": { transform: "scale(0.9)" },
                                "100%": { transform: "scale(1)", opacity: "1" },
                            },
                        },
                    },
                },
            };
        </script>
        <style>
            /* ê³ ê¸‰ Sans-serif í°íŠ¸ ìŠ¤íƒ */
            * {
                font-family: -apple-system, BlinkMacSystemFont, "Segoe UI",
                    "Roboto", "Helvetica Neue", "Arial", "Noto Sans", sans-serif,
                    "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol",
                    "Noto Color Emoji";
            }

            /* ê¸°ë³¸ íƒ€ì´í¬ê·¸ë˜í”¼ ê°œì„  */
            body {
                font-feature-settings: "kern" 1, "liga" 1, "calt" 1;
                text-rendering: optimizeLegibility;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            /* ì œëª© í°íŠ¸ ê°€ì¤‘ì¹˜ ê°œì„  */
            h1,
            h2,
            h3 {
                font-weight: 700;
                letter-spacing: -0.025em;
            }

            /* ë²„íŠ¼ í…ìŠ¤íŠ¸ ê°œì„  */
            button {
                font-weight: 600;
                letter-spacing: 0.025em;
            }

            /* ì´ë²¤íŠ¸ íƒœê·¸ í…ìŠ¤íŠ¸ ê°œì„  */
            .event-tag {
                font-weight: 500;
                letter-spacing: 0.01em;
                font-size: 0.75rem;
            }

            .calendar-grid {
                display: grid;
                grid-template-columns: repeat(7, 1fr);
            }

            .calendar-day {
                min-height: 120px;
                transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
                position: relative;
                overflow: hidden;
                background: rgba(255, 255, 255, 0.95);
                border: 1px solid rgba(226, 232, 240, 0.8);
            }

            .calendar-day::before {
                content: "";
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: linear-gradient(
                    135deg,
                    rgba(59, 130, 246, 0.05) 0%,
                    rgba(59, 130, 246, 0.02) 100%
                );
                opacity: 0;
                transition: opacity 0.3s ease;
                pointer-events: none;
            }

            .calendar-day:hover::before {
                opacity: 1;
            }

            .calendar-day:hover {
                transform: translateY(-1px) scale(1.01);
                box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1),
                    0 2px 4px -1px rgba(0, 0, 0, 0.06);
                z-index: 10;
            }

            .event-tag {
                font-size: 0.75rem;
                padding: 4px 8px;
                border-radius: 6px;
                margin: 2px 0;
                white-space: nowrap;
                overflow: hidden;
                text-overflow: ellipsis;
                transition: all 0.2s ease;
                position: relative;
                border: 1px solid rgba(255, 255, 255, 0.3);
                box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            }

            .event-tag:hover {
                transform: translateX(1px);
                box-shadow: 0 2px 4px 0 rgba(0, 0, 0, 0.1);
            }

            .event-tag.bg-company {
                background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            }

            .event-tag.bg-aptamil {
                background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            }

            .event-tag.bg-dreamy {
                background: linear-gradient(135deg, #f97316 0%, #ea580c 100%);
            }

            .event-tag.bg-btmall {
                background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            }

            .tooltip {
                position: fixed;
                background: #1f2937;
                color: white;
                padding: 8px 12px;
                border-radius: 6px;
                font-size: 0.875rem;
                z-index: 1000;
                pointer-events: none;
                opacity: 0;
                max-width: 250px;
                box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
                border: 1px solid #374151;
            }

            .tooltip.show {
                opacity: 1;
            }

            .glass-effect {
                background: rgba(255, 255, 255, 0.9);
                backdrop-filter: blur(10px);
                border: 1px solid rgba(226, 232, 240, 0.8);
                box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1),
                    0 1px 2px 0 rgba(0, 0, 0, 0.06);
            }

            .gradient-bg {
                background: linear-gradient(
                    135deg,
                    #ffffff 0%,
                    #f8fafc 50%,
                    #f1f5f9 100%
                );
            }

            .floating-card {
                box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1),
                    0 2px 4px -1px rgba(0, 0, 0, 0.06);
                transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            }

            .floating-card:hover {
                transform: translateY(-2px);
                box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1),
                    0 4px 6px -2px rgba(0, 0, 0, 0.05);
            }

            .btn-modern {
                background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
                transition: all 0.3s ease;
                position: relative;
                overflow: hidden;
                box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1),
                    0 1px 2px 0 rgba(0, 0, 0, 0.06);
            }

            .btn-modern::before {
                content: "";
                position: absolute;
                top: 0;
                left: -100%;
                width: 100%;
                height: 100%;
                background: linear-gradient(
                    90deg,
                    transparent,
                    rgba(255, 255, 255, 0.2),
                    transparent
                );
                transition: left 0.5s;
            }

            .btn-modern:hover::before {
                left: 100%;
            }

            .btn-modern:hover {
                transform: translateY(-1px);
                box-shadow: 0 4px 6px -1px rgba(59, 130, 246, 0.3),
                    0 2px 4px -1px rgba(59, 130, 246, 0.2);
            }

            @media (max-width: 768px) {
                .calendar-day {
                    min-height: 80px;
                    padding: 8px !important;
                }

                .event-tag {
                    font-size: 0.625rem;
                    padding: 2px 4px;
                    margin: 1px 0;
                }

                .container {
                    padding-left: 8px !important;
                    padding-right: 8px !important;
                }

                h1 {
                    font-size: 1.875rem !important;
                    line-height: 2.25rem !important;
                }

                h2 {
                    font-size: 1.5rem !important;
                }

                h3 {
                    font-size: 1.25rem !important;
                }

                .p-8 {
                    padding: 1rem !important;
                }

                .space-x-6 > * + * {
                    margin-left: 1rem !important;
                }

                .space-x-4 > * + * {
                    margin-left: 0.75rem !important;
                }

                .space-x-3 > * + * {
                    margin-left: 0.5rem !important;
                }

                .grid-cols-4 {
                    grid-template-columns: repeat(2, minmax(0, 1fr)) !important;
                }

                .text-lg {
                    font-size: 0.875rem !important;
                }

                .text-xl {
                    font-size: 1rem !important;
                }

                .text-3xl {
                    font-size: 1.5rem !important;
                }

                .text-2xl {
                    font-size: 1.25rem !important;
                }

                .p-4 {
                    padding: 0.75rem !important;
                }

                .p-3 {
                    padding: 0.5rem !important;
                }

                .w-6 {
                    width: 1.25rem !important;
                }

                .h-6 {
                    height: 1.25rem !important;
                }

                .w-8 {
                    width: 1.5rem !important;
                }

                .h-8 {
                    height: 1.5rem !important;
                }

                .w-5 {
                    width: 1rem !important;
                }

                .h-5 {
                    height: 1rem !important;
                }

                .w-3 {
                    width: 0.5rem !important;
                }

                .h-3 {
                    height: 0.5rem !important;
                }
            }

            @media (max-width: 480px) {
                .calendar-day {
                    min-height: 70px;
                    padding: 6px !important;
                }

                .event-tag {
                    font-size: 0.5rem;
                    padding: 1px 3px;
                }

                .flex.justify-between {
                    flex-direction: column;
                    gap: 1rem;
                    align-items: center;
                }

                .flex.items-center.space-x-6 {
                    gap: 0.5rem !important;
                }

                h1 {
                    font-size: 1.5rem !important;
                }

                .text-3xl {
                    font-size: 1.25rem !important;
                }

                .p-8 {
                    padding: 0.75rem !important;
                }

                .space-y-4 > * + * {
                    margin-top: 0.75rem !important;
                }

                .space-y-3 > * + * {
                    margin-top: 0.5rem !important;
                }
            }

            /* ìŠ¤í¬ë¡¤ë°” ì»¤ìŠ¤í„°ë§ˆì´ì§• */
            ::-webkit-scrollbar {
                width: 8px;
            }

            ::-webkit-scrollbar-track {
                background: #f1f5f9;
                border-radius: 4px;
            }

            ::-webkit-scrollbar-thumb {
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                border-radius: 4px;
            }

            ::-webkit-scrollbar-thumb:hover {
                background: linear-gradient(135deg, #5a67d8 0%, #6b46c1 100%);
            }

            /* ìº˜ë¦°ë” ë‚ ì§œ ìˆ«ì ê°œì„  */
            .calendar-day > div:first-child {
                font-weight: 600;
                letter-spacing: -0.02em;
                font-variant-numeric: tabular-nums;
            }

            /* ìš”ì¼ í—¤ë” ê°œì„  */
            .calendar-grid > div:not(.calendar-day) {
                font-weight: 600;
                letter-spacing: 0.02em;
                font-variant-numeric: tabular-nums;
            }

            /* íˆ´í¬ í…ìŠ¤íŠ¸ ê°œì„  */
            .tooltip {
                font-weight: 500;
                letter-spacing: 0.01em;
                line-height: 2;
            }

            /* ê³µì§€ì‚¬í•­ í…ìŠ¤íŠ¸ ê°œì„  */
            .glass-effect p {
                line-height: 1.5;
                letter-spacing: 0.01em;
            }

            /* ë²”ë¡€ í…ìŠ¤íŠ¸ ê°œì„  */
            .legend-item span {
                font-weight: 500;
                letter-spacing: 0.02em;
            }

            /* í˜„ì¬ ì›” í‘œì‹œ ê°œì„  */
            #currentMonth {
                font-weight: 700;
                letter-spacing: -0.03em;
                font-variant-numeric: tabular-nums;
            }

            /* í…ìŠ¤íŠ¸ ì¤„ì„í‘œ ì²˜ë¦¬ */
            .line-clamp-2 {
                display: -webkit-box;
                -webkit-line-clamp: 2;
                -webkit-box-orient: vertical;
                overflow: hidden;
            }

            .truncate {
                overflow: hidden;
                text-overflow: ellipsis;
                white-space: nowrap;
            }
        </style>
    </head>
    <body class="min-h-screen gradient-bg">
        <div class="container mx-auto px-4 py-8 max-w-7xl">
            <!-- ìƒë‹¨ ê³µì§€ì‚¬í•­ ì˜ì—­ -->
            <div
                class="glass-effect rounded-xl sm:rounded-2xl p-4 sm:p-8 mb-6 sm:mb-8 floating-card animate-slide-up"
            >
                <div class="flex justify-between items-center mb-4 sm:mb-6">
                    <h2
                        class="text-xl sm:text-2xl font-bold text-gray-800 flex items-center"
                    >
                        <div
                            class="w-6 h-6 sm:w-8 sm:h-8 bg-gradient-to-r from-orange-400 to-red-500 rounded-full flex items-center justify-center mr-2 sm:mr-3 shadow-sm"
                        >
                            <svg
                                class="w-4 h-4 sm:w-5 sm:h-5 text-white"
                                fill="currentColor"
                                viewBox="0 0 20 20"
                            >
                                <path
                                    fill-rule="evenodd"
                                    d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z"
                                    clip-rule="evenodd"
                                ></path>
                            </svg>
                        </div>
                        ì¤‘ìš” ì¼ì • & ì˜¤ëŠ˜ ì¼ì •
                    </h2>
                    <button
                        id="requestEventBtn"
                        class="px-4 py-2 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-lg font-semibold text-sm hover:from-blue-600 hover:to-blue-700 transition-all duration-300 shadow-sm flex items-center space-x-2"
                    >
                        <svg
                            class="w-4 h-4"
                            fill="none"
                            stroke="currentColor"
                            viewBox="0 0 24 24"
                        >
                            <path
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                stroke-width="2"
                                d="M12 6v6m0 0v6m0-6h6m-6 0H6"
                            ></path>
                        </svg>
                        <span>ì¼ì • ë“±ë¡ ìš”ì²­</span>
                    </button>
                </div>

                <!-- ì¤‘ìš” ì¼ì • ì„¹ì…˜ -->
                <div class="mb-6">
                    <h3
                        class="text-lg font-semibold text-gray-700 mb-3 flex items-center"
                    >
                        <svg
                            class="w-5 h-5 mr-2 text-orange-500"
                            fill="none"
                            stroke="currentColor"
                            viewBox="0 0 24 24"
                        >
                            <path
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                stroke-width="2"
                                d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"
                            ></path>
                        </svg>
                        ì¤‘ìš” ê³µì§€
                    </h3>
                    <div class="space-y-3">
                        <div
                            class="flex items-start space-x-3 p-3 bg-orange-50 rounded-lg border border-orange-200 shadow-sm"
                        >
                            <div
                                class="w-2 h-2 bg-gradient-to-r from-orange-400 to-red-500 rounded-full mt-1.5 flex-shrink-0 animate-pulse-slow"
                            ></div>
                            <div>
                                <p class="font-semibold text-gray-800 text-sm">
                                    ì—°ë§ì—°ì‹œ ë°°ì†¡ ì¼ì • ì•ˆë‚´
                                </p>
                                <p class="text-gray-600 text-xs">
                                    12ì›” 24ì¼~1ì›” 2ì¼ê¹Œì§€ ë°°ì†¡ ì„œë¹„ìŠ¤ ì¼ì‹œ ì¤‘ë‹¨
                                </p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ì˜¤ëŠ˜ ì¼ì • ì„¹ì…˜ -->
                <div>
                    <h3
                        class="text-lg font-semibold text-gray-700 mb-3 flex items-center"
                    >
                        <svg
                            class="w-5 h-5 mr-2 text-green-500"
                            fill="none"
                            stroke="currentColor"
                            viewBox="0 0 24 24"
                        >
                            <path
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                stroke-width="2"
                                d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"
                            ></path>
                        </svg>
                        ì˜¤ëŠ˜ ì¼ì •
                    </h3>
                    <div id="todayEventsList" class="space-y-3">
                        <!-- JavaScriptë¡œ ë™ì  ìƒì„± -->
                    </div>
                </div>
            </div>

            <!-- ìº˜ë¦°ë” ì»¨íŠ¸ë¡¤ -->
            <div
                class="flex flex-col sm:flex-row justify-between items-center mb-8 animate-slide-up gap-4"
            >
                <div class="flex items-center space-x-4 sm:space-x-6">
                    <button
                        id="prevMonth"
                        class="p-2 sm:p-3 rounded-xl bg-white border border-gray-200 hover:bg-gray-50 transition-all duration-300 group shadow-sm"
                    >
                        <svg
                            class="w-5 h-5 sm:w-6 sm:h-6 text-gray-600 group-hover:scale-110 transition-transform"
                            fill="none"
                            stroke="currentColor"
                            viewBox="0 0 24 24"
                        >
                            <path
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                stroke-width="2"
                                d="M15 19l-7-7 7-7"
                            ></path>
                        </svg>
                    </button>
                    <h2
                        id="currentMonth"
                        class="text-2xl sm:text-3xl font-bold text-gray-800"
                    >
                        2024ë…„ 1ì›”
                    </h2>
                    <button
                        id="nextMonth"
                        class="p-2 sm:p-3 rounded-xl bg-white border border-gray-200 hover:bg-gray-50 transition-all duration-300 group shadow-sm"
                    >
                        <svg
                            class="w-5 h-5 sm:w-6 sm:h-6 text-gray-600 group-hover:scale-110 transition-transform"
                            fill="none"
                            stroke="currentColor"
                            viewBox="0 0 24 24"
                        >
                            <path
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                stroke-width="2"
                                d="M9 5l7 7-7 7"
                            ></path>
                        </svg>
                    </button>
                </div>
                <div class="flex items-center space-x-3">
                    <button
                        id="todayBtn"
                        class="px-4 sm:px-6 py-2 sm:py-3 btn-modern text-white rounded-xl font-semibold text-sm sm:text-base"
                    >
                        ì˜¤ëŠ˜
                    </button>
                </div>
            </div>

            <!-- ìš”ì¼ í—¤ë” -->
            <div class="calendar-grid mb-4 animate-slide-up">
                <div
                    class="p-2 sm:p-4 text-center font-bold text-red-500 text-sm sm:text-lg"
                >
                    ì¼
                </div>
                <div
                    class="p-2 sm:p-4 text-center font-bold text-gray-700 text-sm sm:text-lg"
                >
                    ì›”
                </div>
                <div
                    class="p-2 sm:p-4 text-center font-bold text-gray-700 text-sm sm:text-lg"
                >
                    í™”
                </div>
                <div
                    class="p-2 sm:p-4 text-center font-bold text-gray-700 text-sm sm:text-lg"
                >
                    ìˆ˜
                </div>
                <div
                    class="p-2 sm:p-4 text-center font-bold text-gray-700 text-sm sm:text-lg"
                >
                    ëª©
                </div>
                <div
                    class="p-2 sm:p-4 text-center font-bold text-gray-700 text-sm sm:text-lg"
                >
                    ê¸ˆ
                </div>
                <div
                    class="p-2 sm:p-4 text-center font-bold text-blue-500 text-sm sm:text-lg"
                >
                    í† 
                </div>
            </div>

            <!-- ìº˜ë¦°ë” ê·¸ë¦¬ë“œ -->
            <div
                id="calendarGrid"
                class="calendar-grid glass-effect rounded-2xl overflow-hidden floating-card animate-bounce-in"
            >
                <!-- JavaScriptë¡œ ë™ì  ìƒì„± -->
            </div>
        </div>

        <!-- ì¼ì • ë“±ë¡ ìš”ì²­ ëª¨ë‹¬ -->
        <div
            id="eventRequestModal"
            class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4"
        >
            <div
                class="bg-white rounded-2xl shadow-2xl max-w-md w-full max-h-[90vh] overflow-y-auto"
            >
                <div class="p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-xl font-bold text-gray-800">
                            ì¼ì • ë“±ë¡ ìš”ì²­
                            <br />
                            ê°œë°œì¤‘..ì‹ ê·œë“±ë¡ì€ ì „ëµê¸°íšì‹¤<br />
                            ì§€ìœ¤í™˜ì—ê²Œ ì§ì ‘ì „ë‹¬ ë¶€íƒë“œë¦½ë‹ˆë‹¤.
                        </h3>
                        <button
                            id="closeModalBtn"
                            class="text-gray-400 hover:text-gray-600 transition-colors"
                        >
                            <svg
                                class="w-6 h-6"
                                fill="none"
                                stroke="currentColor"
                                viewBox="0 0 24 24"
                            >
                                <path
                                    stroke-linecap="round"
                                    stroke-linejoin="round"
                                    stroke-width="2"
                                    d="M6 18L18 6M6 6l12 12"
                                ></path>
                            </svg>
                        </button>
                    </div>

                    <form id="eventRequestForm" class="space-y-4">
                        <div>
                            <label
                                class="block text-sm font-medium text-gray-700 mb-2"
                                >ìš”ì²­ì *</label
                            >
                            <input
                                type="text"
                                id="requester"
                                name="requester"
                                required
                                class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                            />
                        </div>

                        <div>
                            <label
                                class="block text-sm font-medium text-gray-700 mb-2"
                                >ë‚ ì§œ *</label
                            >
                            <input
                                type="date"
                                id="eventDate"
                                name="eventDate"
                                required
                                class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                            />
                        </div>

                        <div>
                            <label
                                class="block text-sm font-medium text-gray-700 mb-2"
                                >íšŒì‚¬ *</label
                            >
                            <select
                                id="company"
                                name="company"
                                required
                                class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                            >
                                <option value="">íšŒì‚¬ ì„ íƒ</option>
                                <option
                                    value="company"
                                    style="
                                        background-color: #ef4444;
                                        color: white;
                                    "
                                >
                                    ğŸ”´ íšŒì‚¬ì „ì²´
                                </option>
                                <option
                                    value="aptamil"
                                    style="
                                        background-color: #3b82f6;
                                        color: white;
                                    "
                                >
                                    ğŸ”µ ì••íƒ€ë°€
                                </option>
                                <option
                                    value="dreame"
                                    style="
                                        background-color: #f97316;
                                        color: white;
                                    "
                                >
                                    ğŸŸ  ë“œë¦¬ë¯¸
                                </option>
                                <option
                                    value="btmall"
                                    style="
                                        background-color: #eab308;
                                        color: white;
                                    "
                                >
                                    ğŸŸ¡ BTëª°
                                </option>
                            </select>
                        </div>

                        <div>
                            <label
                                class="block text-sm font-medium text-gray-700 mb-2"
                                >ì œëª© *</label
                            >
                            <input
                                type="text"
                                id="eventTitle"
                                name="eventTitle"
                                required
                                class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                            />
                        </div>

                        <div>
                            <label
                                class="block text-sm font-medium text-gray-700 mb-2"
                                >ì„¤ëª…</label
                            >
                            <textarea
                                id="eventDescription"
                                name="eventDescription"
                                rows="3"
                                class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                            ></textarea>
                        </div>

                        <div class="flex space-x-3 pt-4">
                            <button
                                type="button"
                                id="cancelBtn"
                                class="flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors"
                            >
                                ì·¨ì†Œ
                            </button>
                            <button
                                type="submit"
                                class="flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"
                            >
                                ìš”ì²­í•˜ê¸°
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- ë¡œë”© ì˜¤ë²„ë ˆì´ -->
        <div
            id="loadingOverlay"
            class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center"
        >
            <div class="bg-white rounded-lg p-6 flex items-center space-x-3">
                <div
                    class="animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"
                ></div>
                <span class="text-gray-700">ì²˜ë¦¬ ì¤‘...</span>
            </div>
        </div>

        <!-- ì™„ë£Œ ë©”ì‹œì§€ ëª¨ë‹¬ -->
        <div
            id="successModal"
            class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4"
        >
            <div
                class="bg-white rounded-2xl shadow-2xl max-w-md w-full p-6 text-center"
            >
                <div
                    class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4"
                >
                    <svg
                        class="w-8 h-8 text-green-600"
                        fill="none"
                        stroke="currentColor"
                        viewBox="0 0 24 24"
                    >
                        <path
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            stroke-width="2"
                            d="M5 13l4 4L19 7"
                        ></path>
                    </svg>
                </div>
                <h3 class="text-xl font-bold text-gray-800 mb-2">ì ‘ìˆ˜ ì™„ë£Œ</h3>
                <p class="text-gray-600 mb-6">
                    ì¼ì • ë“±ë¡ ìš”ì²­ì´ ì„±ê³µì ìœ¼ë¡œ ì ‘ìˆ˜ë˜ì—ˆìŠµë‹ˆë‹¤.
                </p>
                <button
                    id="closeSuccessModal"
                    class="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"
                >
                    í™•ì¸
                </button>
            </div>
        </div>

        <script>
            class CompanyCalendar {
                constructor() {
                    this.currentDate = new Date();
                    this.events = {}; // ë‚ ì§œë³„ ë§¤í•‘
                    this.currentTooltip = null;
                    this.init();
                }

                async init() {
                    try {
                        await this.loadAllEvents();
                        this.renderCalendar();
                        this.bindEvents();
                        this.renderImportantAndTodayBox();
                        this.bindModalEvents();
                        this.setupDailyWebhook(); // Webhook íƒ€ì´ë¨¸ ì„¤ì •
                    } catch (error) {
                        console.error("ìº˜ë¦°ë” ì´ˆê¸°í™” ì˜¤ë¥˜:", error);
                    }
                }

                // events.jsonì—ì„œ ëª¨ë“  ì¼ì • ë¶ˆëŸ¬ì™€ ë‚ ì§œë³„ë¡œ ë§¤í•‘
                async loadAllEvents() {
                    try {
                        const response = await fetch("events.json");
                        if (!response.ok)
                            throw new Error(
                                "ì¼ì • ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."
                            );
                        const data = await response.json();
                        this.events = {};
                        data.events.forEach((event) => {
                            // ë‚ ì§œë¥¼ ì •í™•í•˜ê²Œ íŒŒì‹± (ì‹œê°„ëŒ€ ë¬¸ì œ í•´ê²°)
                            const eventDate = new Date(
                                event.date + "T00:00:00"
                            );
                            const dateString = this.formatDate(eventDate);

                            if (!this.events[dateString])
                                this.events[dateString] = [];
                            this.events[dateString].push(event);
                        });
                        console.log("ë¡œë“œëœ ì´ë²¤íŠ¸:", this.events);
                    } catch (error) {
                        console.error("ì¼ì • ë°ì´í„° ë¡œë“œ ì˜¤ë¥˜:", error);
                        this.events = {};
                    }
                }

                // ìƒë‹¨ ì¤‘ìš” ì¼ì • & ì˜¤ëŠ˜ ì¼ì • ë°•ìŠ¤ ë Œë”ë§
                renderImportantAndTodayBox() {
                    // ëª¨ë“  ì¤‘ìš” ì¼ì • ìˆ˜ì§‘ (important: true)
                    const todayString = this.formatDate(new Date());
                    let importantEvents = [];

                    Object.keys(this.events).forEach((date) => {
                        this.events[date].forEach((ev) => {
                            if (ev.important) {
                                importantEvents.push({ ...ev, date });
                            }
                        });
                    });

                    // ë‚ ì§œ ìˆœìœ¼ë¡œ ì •ë ¬ (ê°€ê¹Œìš´ ë‚ ì§œë¶€í„°)
                    importantEvents.sort(
                        (a, b) => new Date(a.date) - new Date(b.date)
                    );

                    // ì˜¤ëŠ˜ ì¼ì •
                    const todayEvents = this.events[todayString] || [];

                    // ì¤‘ìš” ì¼ì • ì˜ì—­ DOM
                    const box = document.querySelector(
                        ".glass-effect.rounded-xl"
                    );
                    if (!box) return;
                    box.innerHTML = `
                        <div class="flex justify-between items-center mb-4 sm:mb-6">
                            <h2 class="text-xl sm:text-2xl font-bold text-gray-800 flex items-center">
                                <div class="w-6 h-6 sm:w-8 sm:h-8 bg-gradient-to-r from-orange-400 to-red-500 rounded-full flex items-center justify-center mr-2 sm:mr-3 shadow-sm">
                                    <svg class="w-4 h-4 sm:w-5 sm:h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                        <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                                    </svg>
                                </div>
                                ì¤‘ìš” ì¼ì • & ì˜¤ëŠ˜ ì¼ì •
                            </h2>
                            <button id="requestEventBtn" class="px-4 py-2 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-lg font-semibold text-sm hover:from-blue-600 hover:to-blue-700 transition-all duration-300 shadow-sm flex items-center space-x-2">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                                </svg>
                                <span>ì¼ì • ë“±ë¡ ìš”ì²­</span>
                            </button>
                        </div>
                        <div class="mb-6">
                            <h3 class="text-lg font-semibold text-gray-700 mb-3 flex items-center">
                                <svg class="w-5 h-5 mr-2 text-orange-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"></path>
                                </svg>
                                ì¤‘ìš” ê³µì§€
                            </h3>
                            <div class="space-y-3">
                                ${
                                    importantEvents.length > 0
                                        ? importantEvents
                                              .map(
                                                  (event) => `
                                <div class="flex items-start space-x-3 p-3 bg-orange-50 rounded-lg border border-orange-200 shadow-sm">
                                    <div class="w-2 h-2 bg-gradient-to-r from-orange-400 to-red-500 rounded-full mt-1.5 flex-shrink-0 animate-pulse-slow"></div>
                                    <div class="flex-1">
                                        <div class="flex items-center justify-between mb-1">
                                            <p class="font-semibold text-gray-800 text-sm">${this.escapeHtml(
                                                event.title
                                            )}</p>
                                            <span class="text-xs text-gray-500 ml-2 flex-shrink-0">${
                                                event.date
                                            }</span>
                                        </div>
                                        <p class="text-gray-600 text-xs">${this.escapeHtml(
                                            event.description || ""
                                        )}</p>
                                    </div>
                                </div>`
                                              )
                                              .join("")
                                        : `<div class="text-gray-400 text-sm">ì¤‘ìš” ì¼ì •ì´ ì—†ìŠµë‹ˆë‹¤.</div>`
                                }
                            </div>
                        </div>
                        <div>
                            <h3 class="text-lg font-semibold text-gray-700 mb-3 flex items-center">
                                <svg class="w-5 h-5 mr-2 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                                </svg>
                                ì˜¤ëŠ˜ ì¼ì •
                            </h3>
                            <div id="todayEventsList" class="space-y-3">
                                ${
                                    todayEvents.length === 0
                                        ? `<div class="text-center py-4 text-gray-500"><svg class="w-8 h-8 mx-auto mb-2 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg><p class="text-sm">ì˜¤ëŠ˜ ì¼ì •ì´ ì—†ìŠµë‹ˆë‹¤.</p></div>`
                                        : todayEvents
                                              .map((event) => {
                                                  const typeColors = {
                                                      company: {
                                                          bg: "bg-red-50",
                                                          border: "border-red-200",
                                                          dot: "bg-red-500",
                                                          tag: "bg-red-100 text-red-800",
                                                      },
                                                      aptamil: {
                                                          bg: "bg-blue-50",
                                                          border: "border-blue-200",
                                                          dot: "bg-blue-500",
                                                          tag: "bg-blue-100 text-blue-800",
                                                      },
                                                      dreame: {
                                                          bg: "bg-orange-50",
                                                          border: "border-orange-200",
                                                          dot: "bg-orange-500",
                                                          tag: "bg-orange-100 text-orange-800",
                                                      },
                                                      btmall: {
                                                          bg: "bg-yellow-50",
                                                          border: "border-yellow-200",
                                                          dot: "bg-yellow-500",
                                                          tag: "bg-yellow-100 text-yellow-800",
                                                      },
                                                  };
                                                  const colors =
                                                      typeColors[event.type] ||
                                                      typeColors.company;

                                                  return `
                                    <div class="flex items-start space-x-3 p-3 ${
                                        colors.bg
                                    } rounded-lg border ${
                                                      colors.border
                                                  } shadow-sm">
                                        <div class="w-2 h-2 ${
                                            colors.dot
                                        } rounded-full mt-1.5 flex-shrink-0"></div>
                                        <div class="flex-1 min-w-0">
                                            <div class="flex items-center justify-between mb-1">
                                                <h4 class="font-semibold text-gray-800 text-sm truncate">${this.escapeHtml(
                                                    event.title
                                                )}</h4>
                                                <span class="text-xs text-gray-500 ml-2 flex-shrink-0">${
                                                    event.time || ""
                                                }</span>
                                            </div>
                                            <p class="text-xs text-gray-600 mb-2 line-clamp-2">${this.escapeHtml(
                                                event.description || ""
                                            )}</p>
                                            <div class="flex items-center space-x-2">
                                                <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${
                                                    colors.tag
                                                }">${this.escapeHtml(
                                                      event.type
                                                  )}</span>
                                            </div>
                                        </div>
                                    </div>
                                    `;
                                              })
                                              .join("")
                                }
                            </div>
                        </div>
                    `;
                }

                // ìº˜ë¦°ë” ë Œë”ë§ (ë‚ ì§œë³„ë¡œ events.json ë°ì´í„° ì‚¬ìš©)
                renderCalendar() {
                    try {
                        const year = this.currentDate.getFullYear();
                        const month = this.currentDate.getMonth();
                        const currentMonthElement =
                            document.getElementById("currentMonth");
                        if (currentMonthElement) {
                            currentMonthElement.textContent = `${year}ë…„ ${
                                month + 1
                            }ì›”`;
                        }
                        const firstDay = new Date(year, month, 1);
                        const startDate = new Date(firstDay);
                        const dayOfWeek = firstDay.getDay();
                        startDate.setDate(1 - dayOfWeek);
                        const calendarGrid =
                            document.getElementById("calendarGrid");
                        if (!calendarGrid) {
                            console.error(
                                "ìº˜ë¦°ë” ê·¸ë¦¬ë“œ ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."
                            );
                            return;
                        }
                        calendarGrid.innerHTML = "";
                        for (let i = 0; i < 42; i++) {
                            const currentDate = new Date(startDate);
                            currentDate.setDate(startDate.getDate() + i);
                            const dayElement = this.createDayElement(
                                currentDate,
                                year,
                                month
                            );
                            calendarGrid.appendChild(dayElement);
                        }
                    } catch (error) {
                        console.error("ìº˜ë¦°ë” ë Œë”ë§ ì˜¤ë¥˜:", error);
                    }
                }

                createDayElement(date, currentYear, currentMonth) {
                    try {
                        const dayDiv = document.createElement("div");
                        dayDiv.className =
                            "calendar-day bg-white border border-gray-200 p-3 relative";
                        const isCurrentMonth = date.getMonth() === currentMonth;
                        const isToday = this.isToday(date);
                        const dateString = this.formatDate(date);
                        const dayEvents = this.events[dateString] || [];
                        let dayClass = "text-lg font-bold mb-3 ";
                        if (!isCurrentMonth) {
                            dayClass += "text-gray-400";
                        } else if (date.getDay() === 0) {
                            dayClass += "text-red-500";
                        } else if (date.getDay() === 6) {
                            dayClass += "text-blue-500";
                        } else {
                            dayClass += "text-gray-800";
                        }
                        if (isToday) {
                            dayDiv.classList.add(
                                "bg-blue-50",
                                "border-blue-300"
                            );
                            dayDiv.style.boxShadow =
                                "0 0 0 3px rgba(59, 130, 246, 0.1)";
                        }
                        const eventsHTML = dayEvents
                            .map((event) => {
                                const safeTitle = this.escapeHtml(event.title);
                                const safeType = this.escapeHtml(event.type);
                                const eventColor = this.getEventColor(
                                    event.type
                                );
                                return `<span class="event-tag" style="background-color: ${eventColor}" data-event-title="${safeTitle}" data-event-description="${this.escapeHtml(
                                    event.description
                                )}" data-event-type="${safeType}">${safeTitle}</span>`;
                            })
                            .join("");
                        dayDiv.innerHTML = `
                            <div class="${dayClass}">${date.getDate()}</div>
                            <div class="space-y-2">${eventsHTML}</div>
                        `;
                        dayDiv.querySelectorAll(".event-tag").forEach((tag) => {
                            tag.addEventListener("mouseenter", (e) => {
                                const eventData = {
                                    title: e.target.dataset.eventTitle,
                                    description:
                                        e.target.dataset.eventDescription,
                                    type: e.target.dataset.eventType,
                                };
                                this.showTooltip(e, eventData);
                            });
                            tag.addEventListener("mouseleave", () => {
                                this.hideTooltip();
                            });
                        });
                        return dayDiv;
                    } catch (error) {
                        console.error("ë‚ ì§œ ìš”ì†Œ ìƒì„± ì˜¤ë¥˜:", error);
                        const fallbackDiv = document.createElement("div");
                        fallbackDiv.className =
                            "calendar-day bg-white border border-gray-200 p-3 relative";
                        fallbackDiv.innerHTML = `<div class="text-lg font-bold mb-3 text-gray-800">
                            ${date.getDate()}</div>`;
                        return fallbackDiv;
                    }
                }

                showTooltip(event, eventData) {
                    try {
                        // ê¸°ì¡´ íˆ´í¬ ì œê±°
                        this.hideTooltip();

                        if (!eventData || !eventData.title) {
                            return;
                        }

                        const tooltip = document.createElement("div");
                        tooltip.className = "tooltip";
                        tooltip.innerHTML = `
                            <div style="font-weight: 600; margin-bottom: 4px;">${this.escapeHtml(
                                eventData.title
                            )}</div>
                            <div style="color: #d1d5db; font-size: 0.8rem;">${this.escapeHtml(
                                eventData.description || ""
                            )}</div>
                        `;

                        document.body.appendChild(tooltip);

                        const rect = event.target.getBoundingClientRect();

                        // ê°„ë‹¨í•œ ìœ„ì¹˜ ê³„ì‚°
                        let left = rect.left;
                        let top = rect.bottom + 5;

                        // í™”ë©´ ê²½ê³„ í™•ì¸
                        if (left + 250 > window.innerWidth) {
                            left = window.innerWidth - 260;
                        }
                        if (top + 80 > window.innerHeight) {
                            top = rect.top - 85;
                        }

                        tooltip.style.left = left + "px";
                        tooltip.style.top = top + "px";

                        // ì¦‰ì‹œ í‘œì‹œ
                        tooltip.classList.add("show");
                        this.currentTooltip = tooltip;
                    } catch (error) {
                        console.error("íˆ´í¬ í‘œì‹œ ì˜¤ë¥˜:", error);
                    }
                }

                hideTooltip() {
                    try {
                        if (
                            this.currentTooltip &&
                            this.currentTooltip.parentNode
                        ) {
                            this.currentTooltip.remove();
                        }
                        this.currentTooltip = null;
                    } catch (error) {
                        console.error("íˆ´í¬ ìˆ¨ê¹€ ì˜¤ë¥˜:", error);
                        this.currentTooltip = null;
                    }
                }

                isToday(date) {
                    try {
                        const today = new Date();
                        return date.toDateString() === today.toDateString();
                    } catch (error) {
                        console.error("ì˜¤ëŠ˜ ë‚ ì§œ í™•ì¸ ì˜¤ë¥˜:", error);
                        return false;
                    }
                }

                formatDate(date) {
                    try {
                        // ì‹œê°„ëŒ€ ë¬¸ì œ í•´ê²°ì„ ìœ„í•´ ë¡œì»¬ ë‚ ì§œë¡œ í¬ë§·
                        const year = date.getFullYear();
                        const month = String(date.getMonth() + 1).padStart(
                            2,
                            "0"
                        );
                        const day = String(date.getDate()).padStart(2, "0");
                        return `${year}-${month}-${day}`;
                    } catch (error) {
                        console.error("ë‚ ì§œ í¬ë§· ì˜¤ë¥˜:", error);
                        return "";
                    }
                }

                bindEvents() {
                    try {
                        const prevBtn = document.getElementById("prevMonth");
                        const nextBtn = document.getElementById("nextMonth");
                        const todayBtn = document.getElementById("todayBtn");

                        if (prevBtn) {
                            prevBtn.addEventListener("click", () => {
                                const currentYear =
                                    this.currentDate.getFullYear();
                                const currentMonth =
                                    this.currentDate.getMonth();

                                if (currentMonth === 0) {
                                    // 1ì›”ì—ì„œ ì´ì „ ì›”ë¡œ ê°€ë©´ ì‘ë…„ 12ì›”
                                    this.currentDate = new Date(
                                        currentYear - 1,
                                        11,
                                        1
                                    );
                                } else {
                                    // ê·¸ ì™¸ì—ëŠ” ì´ì „ ì›”ì˜ 1ì¼ë¡œ ì„¤ì •
                                    this.currentDate = new Date(
                                        currentYear,
                                        currentMonth - 1,
                                        1
                                    );
                                }
                                this.renderCalendar();
                            });
                        }

                        if (nextBtn) {
                            nextBtn.addEventListener("click", () => {
                                const currentYear =
                                    this.currentDate.getFullYear();
                                const currentMonth =
                                    this.currentDate.getMonth();

                                if (currentMonth === 11) {
                                    // 12ì›”ì—ì„œ ë‹¤ìŒ ì›”ë¡œ ê°€ë©´ ë‚´ë…„ 1ì›”
                                    this.currentDate = new Date(
                                        currentYear + 1,
                                        0,
                                        1
                                    );
                                } else {
                                    // ê·¸ ì™¸ì—ëŠ” ë‹¤ìŒ ì›”ì˜ 1ì¼ë¡œ ì„¤ì •
                                    this.currentDate = new Date(
                                        currentYear,
                                        currentMonth + 1,
                                        1
                                    );
                                }
                                this.renderCalendar();
                            });
                        }

                        if (todayBtn) {
                            todayBtn.addEventListener("click", () => {
                                this.currentDate = new Date();
                                this.renderCalendar();
                            });
                        }
                    } catch (error) {
                        console.error("ì´ë²¤íŠ¸ ë°”ì¸ë”© ì˜¤ë¥˜:", error);
                    }
                }
                // ë²”ë¡€ìƒ‰ìƒ
                getEventColor(type) {
                    const colors = {
                        company: "#ef4444", // red
                        aptamil: "#3b82f6", // blue
                        dreame: "#f97316", // orange
                        btmall: "#eab308", // yellow
                    };
                    return colors[type] || "#6b7280";
                }

                escapeHtml(str) {
                    return str
                        .replace(/&/g, "&amp;")
                        .replace(/</g, "&lt;")
                        .replace(/>/g, "&gt;")
                        .replace(/"/g, "&quot;")
                        .replace(/'/g, "&#39;");
                }

                // ëª¨ë‹¬ ì´ë²¤íŠ¸ ë°”ì¸ë”©
                bindModalEvents() {
                    const requestBtn =
                        document.getElementById("requestEventBtn");
                    const modal = document.getElementById("eventRequestModal");
                    const closeBtn = document.getElementById("closeModalBtn");
                    const cancelBtn = document.getElementById("cancelBtn");
                    const form = document.getElementById("eventRequestForm");
                    const loadingOverlay =
                        document.getElementById("loadingOverlay");
                    const successModal =
                        document.getElementById("successModal");
                    const closeSuccessBtn =
                        document.getElementById("closeSuccessModal");

                    // ëª¨ë‹¬ ì—´ê¸°
                    if (requestBtn) {
                        requestBtn.addEventListener("click", () => {
                            this.openModal();
                        });
                    }

                    // ëª¨ë‹¬ ë‹«ê¸°
                    if (closeBtn) {
                        closeBtn.addEventListener("click", () => {
                            this.closeModal();
                        });
                    }

                    if (cancelBtn) {
                        cancelBtn.addEventListener("click", () => {
                            this.closeModal();
                        });
                    }

                    // ëª¨ë‹¬ ì™¸ë¶€ í´ë¦­ ì‹œ ë‹«ê¸°
                    if (modal) {
                        modal.addEventListener("click", (e) => {
                            if (e.target === modal) {
                                this.closeModal();
                            }
                        });
                    }

                    // í¼ ì œì¶œ
                    if (form) {
                        form.addEventListener("submit", (e) => {
                            e.preventDefault();
                            this.handleEventRequest();
                        });
                    }

                    // ì„±ê³µ ëª¨ë‹¬ ë‹«ê¸°
                    if (closeSuccessBtn) {
                        closeSuccessBtn.addEventListener("click", () => {
                            this.closeSuccessModal();
                        });
                    }

                    // ESC í‚¤ë¡œ ëª¨ë‹¬ ë‹«ê¸°
                    document.addEventListener("keydown", (e) => {
                        if (e.key === "Escape") {
                            this.closeModal();
                            this.closeSuccessModal();
                        }
                    });
                }

                // ëª¨ë‹¬ ì—´ê¸°
                openModal() {
                    const modal = document.getElementById("eventRequestModal");
                    if (modal) {
                        modal.classList.remove("hidden");
                        // ì˜¤ëŠ˜ ë‚ ì§œë¥¼ ê¸°ë³¸ê°’ìœ¼ë¡œ ì„¤ì •
                        const dateInput = document.getElementById("eventDate");
                        if (dateInput) {
                            dateInput.value = new Date()
                                .toISOString()
                                .split("T")[0];
                        }
                    }
                }

                // ëª¨ë‹¬ ë‹«ê¸°
                closeModal() {
                    const modal = document.getElementById("eventRequestModal");
                    const form = document.getElementById("eventRequestForm");
                    if (modal) {
                        modal.classList.add("hidden");
                    }
                    if (form) {
                        form.reset();
                    }
                }

                // ì„±ê³µ ëª¨ë‹¬ ë‹«ê¸°
                closeSuccessModal() {
                    const successModal =
                        document.getElementById("successModal");
                    if (successModal) {
                        successModal.classList.add("hidden");
                    }
                }

                // ì¼ì • ìš”ì²­ ì²˜ë¦¬
                async handleEventRequest() {
                    const form = document.getElementById("eventRequestForm");
                    const loadingOverlay =
                        document.getElementById("loadingOverlay");
                    const successModal =
                        document.getElementById("successModal");

                    if (!form) return;

                    const formData = new FormData(form);
                    const requestData = {
                        requester: formData.get("requester"),
                        eventDate: formData.get("eventDate"),
                        company: formData.get("company"),
                        eventTitle: formData.get("eventTitle"),
                        eventDescription: formData.get("eventDescription"),
                        requestTime: new Date().toISOString(),
                    };

                    // í™•ì¸ ì°½
                    const confirmed = confirm("ì´ëŒ€ë¡œ ë“±ë¡í• ê¹Œìš”?");
                    if (!confirmed) return;

                    try {
                        // ë¡œë”© í‘œì‹œ
                        if (loadingOverlay) {
                            loadingOverlay.classList.remove("hidden");
                        }

                        // ì‹¤ì œ API í˜¸ì¶œ (ì—¬ê¸°ì„œëŠ” ì‹œë®¬ë ˆì´ì…˜)
                        await this.submitEventRequest(requestData);

                        // ëª¨ë‹¬ ë‹«ê¸°
                        this.closeModal();

                        // ë¡œë”© ìˆ¨ê¸°ê¸°
                        if (loadingOverlay) {
                            loadingOverlay.classList.add("hidden");
                        }

                        // ì„±ê³µ ëª¨ë‹¬ í‘œì‹œ
                        if (successModal) {
                            successModal.classList.remove("hidden");
                        }
                    } catch (error) {
                        console.error("ì¼ì • ìš”ì²­ ì²˜ë¦¬ ì˜¤ë¥˜:", error);
                        alert("ì¼ì • ìš”ì²­ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");

                        // ë¡œë”© ìˆ¨ê¸°ê¸°
                        if (loadingOverlay) {
                            loadingOverlay.classList.add("hidden");
                        }
                    }
                }

                // ì¼ì • ìš”ì²­ ì œì¶œ
                async submitEventRequest(requestData) {
                    try {
                        console.log("ì¼ì • ìš”ì²­ ë°ì´í„°:", requestData);

                        // Google Apps Script í™˜ê²½ì¸ì§€ í™•ì¸
                        if (typeof google !== "undefined" && google.script) {
                            // Google Apps Script í™˜ê²½ - ì‹¤ì œ í•¨ìˆ˜ í˜¸ì¶œ
                            return new Promise((resolve, reject) => {
                                google.script.run
                                    .withSuccessHandler(function (result) {
                                        console.log(
                                            "Google Apps Script ì‘ë‹µ:",
                                            result
                                        );
                                        resolve(result);
                                    })
                                    .withFailureHandler(function (error) {
                                        console.error(
                                            "Google Apps Script ì˜¤ë¥˜:",
                                            error
                                        );
                                        reject(
                                            new Error(
                                                error.message ||
                                                    "ì¼ì • ìš”ì²­ ì œì¶œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤."
                                            )
                                        );
                                    })
                                    .submitEventRequest(requestData);
                            });
                        } else {
                            // ë¡œì»¬ í™˜ê²½ - Google Apps Script API ì§ì ‘ í˜¸ì¶œ
                            console.log(
                                "ë¡œì»¬ í™˜ê²½ì—ì„œ Google Apps Script API í˜¸ì¶œ"
                            );

                            const googleAppsScriptUrl =
                                "https://script.google.com/macros/s/AKfycbzGOrivcOR2O0pphxWZoA8Jzzejyil2i5mQe1ePMWXkGQGxRfTnZwOZUeoUaR2NODRj/exec";

                            const response = await fetch(googleAppsScriptUrl, {
                                method: "POST",
                                headers: {
                                    "Content-Type": "application/json",
                                },
                                body: JSON.stringify({
                                    action: "submitEventRequest",
                                    data: requestData,
                                }),
                            });

                            if (response.ok) {
                                const result = await response.json();
                                console.log(
                                    "Google Apps Script API ì‘ë‹µ:",
                                    result
                                );
                                return result;
                            } else {
                                throw new Error(
                                    `HTTP ${response.status}: ${response.statusText}`
                                );
                            }
                        }
                    } catch (error) {
                        console.error("ì¼ì • ìš”ì²­ ì²˜ë¦¬ ì˜¤ë¥˜:", error);
                        throw error;
                    }
                }

                // ë§¤ì¼ 08:00ì— Webhook ë°œì†¡ ì„¤ì •
                setupDailyWebhook() {
                    try {
                        // ë‹¤ìŒ 08:00ê¹Œì§€ ëŒ€ê¸° ì‹œê°„ ê³„ì‚°
                        const now = new Date();
                        const targetTime = new Date();
                        targetTime.setHours(8, 0, 0, 0); // í•œêµ­ì‹œê°„ 08:00

                        // ì˜¤ëŠ˜ 08:00ì´ ì§€ë‚¬ìœ¼ë©´ ë‚´ì¼ 08:00ìœ¼ë¡œ ì„¤ì •
                        if (now >= targetTime) {
                            targetTime.setDate(targetTime.getDate() + 1);
                        }

                        const timeUntilTarget =
                            targetTime.getTime() - now.getTime();

                        console.log(
                            `ë‹¤ìŒ Webhook ë°œì†¡: ${targetTime.toLocaleString(
                                "ko-KR"
                            )}`
                        );

                        // ì²« ë²ˆì§¸ ì‹¤í–‰
                        setTimeout(() => {
                            this.sendDailyWebhook();
                            // ì´í›„ 24ì‹œê°„ë§ˆë‹¤ ë°˜ë³µ
                            setInterval(() => {
                                this.sendDailyWebhook();
                            }, 24 * 60 * 60 * 1000); // 24ì‹œê°„
                        }, timeUntilTarget);
                    } catch (error) {
                        console.error("Webhook íƒ€ì´ë¨¸ ì„¤ì • ì˜¤ë¥˜:", error);
                    }
                }

                // ë§¤ì¼ 08:00ì— ì‹¤í–‰ë˜ëŠ” Webhook ë°œì†¡
                async sendDailyWebhook() {
                    try {
                        const todayString = this.formatDate(new Date());
                        const todayEvents = this.events[todayString] || [];

                        if (todayEvents.length === 0) {
                            console.log(
                                "ì˜¤ëŠ˜ ì¼ì •ì´ ì—†ì–´ Webhook ë°œì†¡ì„ ê±´ë„ˆëœë‹ˆë‹¤."
                            );
                            return;
                        }

                        // Webhook URL ì„¤ì • (ë‚˜ì¤‘ì— ë³€ê²½ ê°€ëŠ¥)
                        const webhookUrl =
                            "https://your-webhook-url.com/events"; // â† ì—¬ê¸°ì— ì‹¤ì œ URL ì…ë ¥

                        const payload = {
                            date: todayString,
                            events: todayEvents,
                            timestamp: new Date().toISOString(),
                            timezone: "Asia/Seoul",
                            message: `ğŸ“… ${todayString} ì˜¤ëŠ˜ ì¼ì • ì•ˆë‚´`,
                            totalEvents: todayEvents.length,
                        };

                        const response = await fetch(webhookUrl, {
                            method: "POST",
                            headers: {
                                "Content-Type": "application/json",
                                "User-Agent": "TeamScheduler/1.0",
                            },
                            body: JSON.stringify(payload),
                        });

                        if (response.ok) {
                            console.log(
                                `âœ… ${todayString} ì˜¤ëŠ˜ ì¼ì •ì´ Webhookìœ¼ë¡œ ì„±ê³µì ìœ¼ë¡œ ë°œì†¡ë˜ì—ˆìŠµë‹ˆë‹¤.`
                            );
                            console.log(
                                "ë°œì†¡ëœ ì¼ì •:",
                                todayEvents.map((e) => e.title)
                            );
                        } else {
                            throw new Error(
                                `HTTP ${response.status}: ${response.statusText}`
                            );
                        }
                    } catch (error) {
                        console.error("Webhook ë°œì†¡ ì˜¤ë¥˜:", error);
                        console.log(
                            "Webhook URLì„ í™•ì¸í•˜ê±°ë‚˜ ë„¤íŠ¸ì›Œí¬ ì—°ê²°ì„ ì ê²€í•´ì£¼ì„¸ìš”."
                        );
                    }
                }

                // ìˆ˜ë™ìœ¼ë¡œ Webhook ë°œì†¡ (í…ŒìŠ¤íŠ¸ìš©)
                async sendWebhookNow() {
                    console.log("ìˆ˜ë™ Webhook ë°œì†¡ ì‹œì‘...");
                    await this.sendDailyWebhook();
                }
            }

            // ìº˜ë¦°ë” ì´ˆê¸°í™”
            document.addEventListener("DOMContentLoaded", () => {
                try {
                    const calendar = new CompanyCalendar();
                    window.calendar = calendar;
                } catch (error) {
                    console.error("ìº˜ë¦°ë” ì´ˆê¸°í™” ì‹¤íŒ¨:", error);
                    // ì‚¬ìš©ìì—ê²Œ ì˜¤ë¥˜ ë©”ì‹œì§€ í‘œì‹œ
                    const container = document.querySelector(".container");
                    if (container) {
                        container.innerHTML = `
                            <div class="text-center py-8">
                                <h2 class="text-xl font-bold text-red-600 mb-4">ìº˜ë¦°ë” ë¡œë“œ ì˜¤ë¥˜</h2>
                                <p class="text-gray-600">í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•´ì£¼ì„¸ìš”.</p>
                            </div>
                        `;
                    }
                }
            });
        </script>
    </body>
</html>
